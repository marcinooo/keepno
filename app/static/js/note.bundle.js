"use strict";(self.webpackChunkfrontend_scripts=self.webpackChunkfrontend_scripts||[]).push([[793],{129:(e,t,n)=>{var r=n(114),o=n(648);window.addEventListener("load",(function(){var e=(0,o.e)();console.log(e);var t=document.querySelector("#entries"),n=document.querySelector("#entries-template"),a=document.querySelector("#entries-loading-spiner"),c=new bootstrap.Modal(document.querySelector("#addEntryModal")),d=document.querySelector("#deleteEntryModal"),i=new bootstrap.Modal(d),s=d.querySelector("#deleteEntryButton"),l=document.querySelector("#save-entry"),u=document.querySelector("#updateEntryModal"),y=new bootstrap.Modal(u),p=u.querySelector("#updateEntryButton"),h=1,f=!0,m=new Event("loadEntriesAfterPageOpeningEvent"),b=new Quill("#add-editor-container",{modules:{syntax:!0,toolbar:"#add-toolbar-container"},placeholder:"Compose an epic...",theme:"snow"}),v=new Quill("#update-editor-container",{modules:{syntax:!0,toolbar:"#update-toolbar-container"},placeholder:"Compose an epic...",theme:"snow"});function E(e,t){e.querySelector("#content").innerHTML=t.content,e.querySelector("#created").innerHTML=t.created;var n=e.querySelector("#deleteEntryLink");n.id="deleteMobalOpenButton".concat(t.id),n.dataset.entryid=t.id;var r=e.querySelector("#updateEntryLink");return r.id="updateMobalOpenButton".concat(t.id),r.dataset.entryid=t.id,e.querySelector("#entryRow").id="entry".concat(t.id),e}function w(e){for(var r=0;r<e.entries.length;r++)o=e.entries[r],c=t,d=void 0,d=E(d=n.content.cloneNode(!0),o),c.appendChild(d);var o,c,d;e.has_next?(h=e.next_num,f=!0):(f=!1,a.style.display="none")}var g=new IntersectionObserver((function(t){t[0].intersectionRatio<=0||f&&fetch("/api/notes/".concat(e,"/entries?epage=").concat(h)).then((function(e){return e.json()})).then((function(e){w(e)})).catch((function(e){console.log(e),r.Z.error("There was a problem. Entries couldn't be downloaded.")}))}));document.addEventListener("loadEntriesAfterPageOpeningEvent",(function(t){f&&fetch("/api/notes/".concat(e,"/entries?epage=").concat(h)).then((function(e){return e.json()})).then((function(e){e.entries?w(e):(r.Z.warning(e.error),f=!1,a.style.display="none"),document.documentElement.scrollHeight>document.documentElement.clientHeight||e.error?g.observe(a):document.dispatchEvent(m)})).catch((function(e){console.log(e),r.Z.error("There was a problem. Entries couldn't be downloaded.")}))})),l.addEventListener("click",(function(a){var d="<p><br></p>"===b.root.innerHTML.trim()?"":b.root.innerHTML;fetch("/api/notes/".concat(e,"/entries"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:d,note_id:e})}).then((function(e){return e.json()})).then((function(e){if(e.entry)d=e.entry,i=t,s=E(s=n.content.cloneNode(!0),d),i.insertBefore(s,i.firstChild.nextSibling),b.root.innerHTML="",c.hide(),r.Z.success("New entry has been added successfully!");else{var a=(0,o.T)(e.error,"Your entry was not added:<br/>");r.Z.error(a)}var d,i,s})).catch((function(e){console.log(e),r.Z.error("There was a problem. The entry was not added!")}))})),d.addEventListener("show.bs.modal",(function(e){var t=e.relatedTarget.getAttribute("data-entryid");s.dataset.entryid=t})),s.addEventListener("click",(function(t){fetch("/api/notes/".concat(e,"/entries/").concat(t.target.dataset.entryid),{method:"DELETE"}).then((function(e){return e.json()})).then((function(e){if(e.entry){var n=document.getElementById("entry".concat(t.target.dataset.entryid));i.hide(),n.remove(),r.Z.success("Entry has been deleted successfully!")}else{var a=(0,o.T)(e.error,"Your entry was not deleted:<br/>");r.Z.error(a)}})).catch((function(e){console.log(e),r.Z.error("There was a problem. Entry couldn't be deleted.")}))})),u.addEventListener("show.bs.modal",(function(e){var t=e.relatedTarget.getAttribute("data-entryid");p.dataset.entryid=t;var n=document.querySelector("#entry".concat(t," #content"));v.root.innerHTML=n.innerHTML})),p.addEventListener("click",(function(t){var n="<p><br></p>"===v.root.innerHTML.trim()?"":v.root.innerHTML;fetch("/api/notes/".concat(e,"/entries/").concat(t.target.dataset.entryid),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,note_id:e})}).then((function(e){return e.json()})).then((function(e){if(e.entry)document.querySelector("#entry".concat(t.target.dataset.entryid," #content")).innerHTML=n,v.root.innerHTML="",y.hide(),r.Z.success("Entry has been updated successfully!");else{var a=(0,o.T)(e.error,"Your entry was not updated:<br/>");r.Z.error(a)}})).catch((function(e){console.log(e),r.Z.error("There was a problem. The entry was not updated!")}))})),document.dispatchEvent(m)}))}},e=>{e.O(0,[493,957],(()=>(129,e(e.s=129)))),e.O()}]);